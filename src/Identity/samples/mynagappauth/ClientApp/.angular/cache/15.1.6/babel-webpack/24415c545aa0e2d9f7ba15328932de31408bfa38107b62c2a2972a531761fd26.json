{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction FetchDataComponent_div_4_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Confirm password: \");\n    i0.ɵɵelement(2, \"input\", 8);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction FetchDataComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h1\");\n    i0.ɵɵtext(2, \"Cool stuff is waiting for authenticated people\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\")(4, \"form\", 2, 3);\n    i0.ɵɵlistener(\"ngSubmit\", function FetchDataComponent_div_4_Template_form_ngSubmit_4_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const _r2 = i0.ɵɵreference(5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.validate(_r2));\n    });\n    i0.ɵɵelementStart(6, \"div\");\n    i0.ɵɵtext(7, \"Username: \");\n    i0.ɵɵelement(8, \"input\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\");\n    i0.ɵɵtext(10, \"Password: \");\n    i0.ɵɵelement(11, \"input\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, FetchDataComponent_div_4_div_12_Template, 3, 0, \"div\", 1);\n    i0.ɵɵelementStart(13, \"button\", 6);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"button\", 7);\n    i0.ɵɵlistener(\"onclick\", function FetchDataComponent_div_4_Template_button_onclick_15_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.toggleRegister());\n    });\n    i0.ɵɵtext(16, \"Switch to {{ register ? \\\"Login\\\" : \\\"Register\\\"\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.register);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.register ? \"Register\" : \"Login\");\n  }\n}\nfunction FetchDataComponent_div_5_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction FetchDataComponent_div_5_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Welcome, \", ctx_r8.fx.username, \"\");\n  }\n}\nfunction FetchDataComponent_div_5_div_3_canvas_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"canvas\", 10);\n  }\n  if (rf & 2) {\n    const eff_r11 = ctx.$implicit;\n    i0.ɵɵattribute(\"data-js\", eff_r11);\n  }\n}\nfunction FetchDataComponent_div_5_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, FetchDataComponent_div_5_div_3_canvas_1_Template, 1, 1, \"canvas\", 9);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r9.fx.effects);\n  }\n}\nfunction FetchDataComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, FetchDataComponent_div_5_p_1_Template, 3, 0, \"p\", 1);\n    i0.ɵɵtemplate(2, FetchDataComponent_div_5_p_2_Template, 2, 1, \"p\", 1);\n    i0.ɵɵtemplate(3, FetchDataComponent_div_5_div_3_Template, 2, 1, \"div\", 1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.fx);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.fx && ctx_r1.fx.username);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.fx);\n  }\n}\nexport class FetchDataComponent {\n  fetch() {\n    this.operationFailed = false;\n    this.http.get(this.baseUrl + 'effects').subscribe(result => {\n      this.fx = result;\n      if (this.fx.username) {\n        this.authenticated = true;\n      } else {\n        this.authenticated = false;\n      }\n    }, error => {\n      this.authenticated = false;\n      this.operationFailed = true;\n      this.operationReason = error;\n    });\n  }\n  toggleRegister() {\n    this.register = this.register ? false : true;\n  }\n  submitRegistration(f) {\n    this.operationFailed = false;\n    this.http.post(this.baseUrl + 'identity/v1/register', {\n      username: f.value.username,\n      password: f.value.password\n    }).subscribe(_ => {\n      this.authenticated = true;\n      this.fetch();\n    }, error => {\n      this.operationFailed = true;\n      this.operationReason = error;\n    });\n  }\n  login(username, password) {\n    this.operationFailed = false;\n    this.http.post(this.baseUrl + 'identity/v1/login', {\n      username: username,\n      password: password,\n      cookieMode: true\n    }).subscribe(_ => {\n      this.authenticated = true;\n      this.fetch();\n    }, error => {\n      this.authenticated = false;\n      this.operationFailed = true;\n      this.operationReason = error;\n    });\n  }\n  constructor(http, baseUrl) {\n    this.http = http;\n    this.baseUrl = baseUrl;\n    this.authenticated = false;\n    this.register = false;\n    this.operationFailed = false;\n    this.operationReason = \"\";\n    http.get(baseUrl + 'effects').subscribe(result => {\n      this.fx = result;\n      if (this.fx.username) {\n        this.authenticated = true;\n      }\n    }, error => console.error(error));\n  }\n}\nFetchDataComponent.ɵfac = function FetchDataComponent_Factory(t) {\n  return new (t || FetchDataComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject('BASE_URL'));\n};\nFetchDataComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: FetchDataComponent,\n  selectors: [[\"app-fetch-data\"]],\n  decls: 6,\n  vars: 2,\n  consts: [[\"id\", \"tableLabel\"], [4, \"ngIf\"], [3, \"ngSubmit\"], [\"f\", \"ngForm\"], [\"type\", \"text\", \"name\", \"username\", \"ngModel\", \"\"], [\"type\", \"password\", \"name\", \"password\", \"ngModel\", \"\"], [\"type\", \"submit\"], [3, \"onclick\"], [\"type\", \"password\", \"name\", \"pconfirm\", \"ngModel\", \"\"], [\"width\", \"800\", \"height\", \"640\", \"style\", \"background: black;\", 4, \"ngFor\", \"ngForOf\"], [\"width\", \"800\", \"height\", \"640\", 2, \"background\", \"black\"]],\n  template: function FetchDataComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\", 0);\n      i0.ɵɵtext(1, \"JavaScript Effects\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"p\");\n      i0.ɵɵtext(3, \"This component demonstrates fetching data protected by auth from the server.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(4, FetchDataComponent_div_4_Template, 17, 2, \"div\", 1);\n      i0.ɵɵtemplate(5, FetchDataComponent_div_5_Template, 4, 3, \"div\", 1);\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", !ctx.authenticated);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.authenticated);\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.NgModel, i3.NgForm],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["i0","FetchDataComponent","fetch","operationFailed","http","get","baseUrl","subscribe","result","fx","username","authenticated","error","operationReason","toggleRegister","register","submitRegistration","f","post","value","password","_","login","cookieMode","constructor","console","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\jeliknes\\source\\repos\\aspnetcore\\src\\identity\\samples\\mynagappauth\\ClientApp\\src\\app\\fetch-data\\fetch-data.component.html","C:\\Users\\jeliknes\\source\\repos\\aspnetcore\\src\\identity\\samples\\mynagappauth\\ClientApp\\src\\app\\fetch-data\\fetch-data.component.ts"],"sourcesContent":["<h1 id=\"tableLabel\">JavaScript Effects</h1>\r\n\r\n<p>This component demonstrates fetching data protected by auth from the server.</p>\r\n\r\n<div *ngIf=\"!authenticated\">\r\n    <h1>Cool stuff is waiting for authenticated people</h1>\r\n    <div>\r\n        <form #f=\"ngForm\" (ngSubmit)=\"validate(f)\">\r\n            <div>Username:        <input type=\"text\" name=\"username\" ngModel></div>\r\n            <div>Password:        <input type=\"password\" name=\"password\" ngModel></div>                              \r\n            <div *ngIf=\"register\">Confirm password: <input type=\"password\" name=\"pconfirm\" ngModel></div>\r\n            <button type=\"submit\">{{ register ? \"Register\" : \"Login\" }}</button>\r\n        </form>\r\n        <button (onclick)=\"toggleRegister()\">Switch to {{ register ? \"Login\" : \"Register\"</button>\r\n    </div>\r\n</div>\r\n\r\n<div *ngIf=\"authenticated\">\r\n\r\n    <p *ngIf=\"!fx\"><em>Loading...</em></p>\r\n\r\n    <p *ngIf=\"fx && fx.username\">Welcome, {{ fx.username }}</p>\r\n\r\n    <div *ngIf=\"fx\">\r\n      <canvas *ngFor=\"let eff of fx.effects\" [attr.data-js]=\"eff\" width=\"800\" height=\"640\" style=\"background: black;\">\r\n      </canvas>  \r\n    </div>\r\n\r\n</div>\r\n","import { Component, Inject } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { NgForm } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-fetch-data',\r\n  templateUrl: './fetch-data.component.html'\r\n})\r\nexport class FetchDataComponent {\r\n  public fx?: Effects;\r\n  public authenticated: boolean = false;\r\n  public register: boolean = false;\r\n  public operationFailed: boolean = false;\r\n  public operationReason: string = \"\";\r\n  public fetch() {\r\n    this.operationFailed = false;\r\n    this.http.get<Effects>(this.baseUrl + 'effects').subscribe(result => {\r\n      this.fx = result;\r\n      if (this.fx.username) {\r\n        this.authenticated = true;\r\n      }\r\n      else {\r\n        this.authenticated = false;\r\n      }\r\n    },\r\n      error => {\r\n        this.authenticated = false;\r\n        this.operationFailed = true;\r\n        this.operationReason = error;\r\n      });\r\n  }\r\n  \r\n  public toggleRegister() {\r\n    this.register = this.register ? false : true; \r\n  };\r\n\r\n  public submitRegistration(f: NgForm) {\r\n    this.operationFailed = false;\r\n    this.http.post(this.baseUrl + 'identity/v1/register', {\r\n      username: f.value.username,\r\n      password: f.value.password\r\n    })\r\n      .subscribe(_ => {\r\n        this.authenticated = true;\r\n        this.fetch();\r\n      }, error => {\r\n        this.operationFailed = true;\r\n        this.operationReason = error;\r\n      });\r\n  };\r\n\r\n  public login(username: string, password: string) {\r\n    this.operationFailed = false;\r\n    this.http.post(this.baseUrl + 'identity/v1/login', {\r\n      username: username, password: password, cookieMode: true\r\n    })\r\n      .subscribe(_ => {\r\n        this.authenticated = true;\r\n        this.fetch();\r\n      }, error => {\r\n        this.authenticated = false;\r\n        this.operationFailed = true;\r\n        this.operationReason = error;\r\n      });\r\n  };\r\n\r\n  constructor(private http: HttpClient, @Inject('BASE_URL') private baseUrl: string) {\r\n    http.get<Effects>(baseUrl + 'effects').subscribe(result => {      \r\n      this.fx = result;\r\n      if (this.fx.username) {\r\n        this.authenticated = true;\r\n      }\r\n    },\r\n      error => console.error(error));\r\n  }\r\n}\r\n\r\ninterface Effects {\r\n  username: string;\r\n  effects: string[];  \r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}